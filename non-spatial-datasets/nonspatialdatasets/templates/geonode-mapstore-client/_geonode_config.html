{% extends 'geonode-mapstore-client/_geonode_config.html' %}
{% block override_local_config %}
<script>
    (function() {
        const { overrideLocalConfig } = window.__GEONODE_CONFIG__;

        window.__GEONODE_CONFIG__.overrideLocalConfig = function(localConfig, _) {
            if (overrideLocalConfig) {
                overrideLocalConfig(localConfig, _)
            }

            const { filtersForm, cardsMenu } = localConfig.geoNodeConfiguration;
        
            const datasetItem = filtersForm.items[0].items.filter(i => i.id === 'dataset');

            if (datasetItem[0] && datasetItem[0].items.filter(i => i.id === 'store-nonspatial').length === 0) {
                datasetItem[0].items.push({
                    id: "store-nonspatial",
                    labelId: "gnhome.nonSpatial",
                    type: "filter",
                    query: {
                        "filter{subtype.in}": "nonspatial"
                    }
                });
            }

            cardsMenu.items[0].items.push({
                labelId: "gnhome.nonSpatial",
                value: "nonspatialdataset",
                type: "link",
                href: "/non-spatial-datasets/create",
                authenticated: true,
                perms: [
                    {
                        "type": "user",
                        "value": "add_resource"
                    }
                ]
            });

            return localConfig;
        };
    })();
</script>
{% endblock %}